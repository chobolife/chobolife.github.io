---
layout: single
title:  "Google drive에 공개 이미지 올리기"
excerpt: "#구글드라이브 #역시Google이야 #이미지호스팅"
header:
  overlay_image: /assets/images/computer-1209641_1920.jpg
  overlay_filter: 0.5 # same as adding an opacity of 0.5 to a black background
date:   2019-07-29 22:45:00 +0900
categories: 블로그
tags:
  - 블로그
  - jekyll
  - 구글 드라이브
  - 이미지
  - 공개 설정
---
Jekyll에서 이미지를 올리는 방법에 대해서 찾아보았고, 코드조각이라는 것을 이용하여 나름의 방법을 구축했다.
그 방법을 소개하려고 하는데 그에 앞서 우선 이번 포스팅에서는 Google drive에 이미지 파일을 올리고 웹에 공개하는 방법까지만 작성했다.
그렇게 올린 이미지 파일을 Jekyll post에 표시하는 방법은 다음 포스팅([Jekyll post에 이미지 첨부하기]({{ site.baseurl }}{% link _posts/2019/2019-07-31-jekyll-image.md %}))에서 다룰 예정이다.

## 네이버와 워드프레스에서 이미지 관리 방법의 차이
일단 먼저 생각해 봐야 할 점은 Jekyll에서는 포털사이트의 블로그(예를 들면 네이버 블로그)와 유사한 방법으로 이미지를 다룰 수 없다는 점이다.
굳이 따지자면 오히려 워드프레스의 이미지 관리 방법과 유사하다. 뒤에 얘기하겠지만 그렇다고 같지는 않다.
어쨌든 많이 쓰이는 블로깅 툴이 네이버 블로그와 워드프레스이므로 일단 그 둘의 이미지 관리 방법이 어떻게 다른지부터 생각해 보자.

네이버 블로그에서는 포스팅을 하면서 이미지를 첨부하게 되어 있고, 그렇게 하면 포스팅별로 이미지가 관리된다.
설치형 워드프레스에서는 미디어 라이브러리에 이미지를 올리고 나서 그 이미지를 포스팅할 때 갖다 쓰게 된다.
이것만 보면 별 차이가 없어 보이겠지만
하나의 이미지 파일을 여러 포스팅에서 쓰게 되는 경우를 생각해 보면 얘기가 달라진다.

첫 번째 경우 (네이버 블로그) 같은 경우에는 분명히 똑같은 이미지이지만 포스팅마다 따로 첨부가 된다.
포스트 2개에 같은 이미지 파일을 올리는 경우가 있다면
당연히 서버에도 두 개의 파일이 존재하고, 사용자의 브라우저에도 두 개가 캐싱된다.
서버 저장공간도, 네트워크 리소스도, 사용자의 캐시 메모리도 모두 2배로 필요하다.
만약에 같은 이미지를 포함하는 포스트 3개, 4개 등등으로 더 많아진다면 계속 필요한 자원이 증가한다.

반대로 두 번째 경우 (설치형 워드프레스)에서는 서버에 말 그대로 미디어 라이브러리가 있는 것이다.
프로그램을 짜본 적이 있다면 library라는 말의 의미를 알 것이라고 생각한다.
한 번이라도 Hello World를 출력해 보았다면 이미 library를 사용해 본 것이다.
어쨌든, 워드프레스에서 미디어 라이브러리에는 라이브러리대로 이미지 파일을 올리고
포스팅에서는 그 라이브러리에 있는 파일을 보여주기만 할 뿐이다.
이 때는 서버에 단 하나의 파일만 존재한다.
사용자도 그 이미지가 캐싱되어 있다면, 즉 그 이미지 파일을 포함하는 포스팅을 하나 본 적이 있다면 다른 포스트에서는 이미지를 다시 다운로드하지 않는다.
네트워크 리소스도 절약되고 로딩 속도도 빨라진다.

이렇게만 보면 무조건 두 번째 경우처럼 관리하는 것이 좋을지도 모른다.
하지만 두 번째 경우보다 첫 번째 경우가 직관적이다.
첫 번째 경우는 이미지가 포스트에 종속되기 때문에 포스트를 관리하는 것이 곧 이미지를 관리하는 것이다.
즉 포스트를 삭제하면 이미지도 같이 삭제되며 다른 신경을 쓸 필요가 없다.

그런데 두 번째 경우에서는 이미지는 포스트에 종속되지 않는다.
이미지와 포스트는 독립적으로 존재한다.
그래서 포스트를 삭제해도 이미지는 삭제되지 않는다.
당연한 얘기지만 삭제해서도 안 된다. 그 이미지를 포함하는 모든 포스트가 삭제되었다는 보장이 없으니까.
그 이미지를 포함하는 포스트가 남아 있지 않다고 하더라도 나중에 다른 포스트에서 그 이미지를 띄울 수도 있는 것이기 때문에 미디어 라이브러리가 스스로 이미지를 지울 수는 없다.

## 그렇다면 Jekyll은?
Jekyll에서는 이미지가 포스트에 종속되지 않기 때문에 일단 네이버 블로그와는 방법이 다르다.
그렇다고 해서 워드프레스에서의 방법과 정확히 같은 것은 또 아니다.
Jekyll에서는 워드프레스의 미디어 라이브러리에 해당하는 것이 없다.
즉 미디어 라이브러리가 필요하다면 본인이 구축해야 하며, 필요하지 않다면 구축하지 않아도 된다.
어쨌든 Jekyll에서는 먼저 이미지 파일을 **어떤 방법으로든** 웹에 업로드한 후 포스트를 작성할 때는 그 이미지 파일의 주소로 이미지를 띄워주면 된다.

이미지를 웹에 업로드하는 방법은 무궁무진하다.
Jekyll 폴더 내에 이미지를 넣고 `git commit`으로 웹페이지를 올리듯이 [Github Pages][l-github-pages]{:target='_blank'}에 업로드하는 방법도 있고 [Dropbox][l-dropbox]{:target='_blank'}, [Google Drive][l-google-drive]{:target='_blank'}, [AWS S3][l-aws-s3]{:target='_blank'} 등의 서비스를 이용할 수도 있다.
이 중에서 나는 구글 드라이브를 선택했다.

구글 드라이브를 선택한 이유는 기본적으로 트래픽이 무제한일 뿐 아니라 인증된 기관의 계정에서는 저장 공간도 무제한이기 때문이다.
github, dropbox, AWS S3 모두 저장 공간 또는 발생된 트래픽에 따라 요금이 부과된다.
물론 일정한 수준까지는 부과되지 않으며 보통의 개인용 블로그에서는 그런 수준을 넘지 않을 가능성이 매우 높다.
하지만 어떤 이유로 인하여 옮겨야 한다면 굉장히 번거로울 것 같았다.
그래서 그냥 처음부터 구글 드라이브에 이미지를 올리고 거기서 가져오는 게 나을 거라고 생각했다.
물론 이렇게 하려면 약간 귀찮은 작업이 필요하다.

## Google drive에서 폴더 공개를 위한 설정
우선 구글 드라이브에 로그인하고 이미지 관리를 위한 폴더를 생성하였다.
나는 블로그 이름과 같은 chobolife라는 폴더를 만들고 그 아래에 연, 월에 해당하는 폴더를 생성하였다.
블로깅을 오래 하다보면 이미지 파일도 많아질 것이므로 업로드한 시기에 대한 정보로 폴더를 만들면 관리하기 편할 것 같아서 그렇게 만들었다.
아래 그림과 같은 구조가 생겼다.

{% include i-g.html id="15gGdSU9GkjuDwlojojH7N17YOFS8FWM6" alt="구글 드라이브에 블로그의 이미지 저장소 역할을 할 폴더를 만들었다." title="구글 드라이브에 생성한 폴더" %}

그리고 테스트를 위해 무료 이미지 저장소인 [pixabay][l-pixabay]{:target='_blank'}에서 임의의 사진을 하나 다운받았다.
맨 앞 페이지에 탁 트인 Grand Canyon 사진이 있길래 **시원하게 열릴 내 미래**를 상상하며 그 사진을 받았다.

이 사진을 아까 만들었던 폴더에 올린 후 공개하면 된다.
**그런데 이미지가 여러 개인 경우에는 폴더에 올리고 일일히 공개 설정을 하기보다는, 먼저 폴더를 공개한 후 파일들을 올리는 것이 더 편하다.**
이미지 파일을 올릴 때마다 공개 설정을 해 줄 필요 없이, 공개 설정을 처음에 한 번만 하면 되기 때문이다.
폴더의 공개 설정은 아래와 같이 할 수 있다.

먼저 폴더를 우클릭해서 나오는 메뉴 중에서 **공유**를 클릭한다.

{% include i-g.html id="1pib57QSv3f8YGxS1762drZz6Oj75sUSe" alt="공개하고 싶은 폴더를 우클릭하고 공유를 선택한다." title="구글 드라이브에서 폴더를 공개하기 위한 설정" %}

그러면 아래와 같은 '다른 사용자와 공유'라는 제목의 박스가 뜬다.

{% include i-g.html id="109IKsqmv4P5_-igYm5ejZZcyiSI6D7cd" alt="공유를 선택하면 '다른 사용자와 공유'라는 박스가 뜬다." title="구글 드라이브에서 폴더를 공개하기 위한 설정: 다른 사용자와 공유" %}

이 박스 오른쪽 하단에 작게 쓰여 있는 **고급**을 클릭한다.
그러면 이번에는 다시 이렇게 생긴 '공유 설정'이라는 제목의 박스가 뜬다.

{% include i-g.html id="1WtszGBcf84uU6U-MSzMQtvAdhAzD39MY" alt="고급을 클릭하면 '공유 설정'이라는 박스로 바뀐다." title="구글 드라이브에서 폴더를 공개하기 위한 설정: 공유 설정 이전" %}

여기에서는 가운데에 있는 **비공개 - 나만 액세스할 수 있습니다.** 옆에 있는 **변경**을 클릭한다.
지금은 인증된 기관의 계정으로 로그인된 상태라서 항목의 제목이 **비공개 - 나만 액세스할 수 있습니다.**라고 표시되었지만 다른 구글 계정에서는 다르게 나타날 수 있다.
어쨌든 **변경**을 클릭한다.

{% include i-g.html id="1Co23pALV7t2zhXYL9BnA96Zbt9uLIPWR" alt="이어서 뜨는 '링크 공유' 상자에서는 가장 위의 항목을 선택한다." title="구글 드라이브에서 폴더를 공개하기 위한 설정: 링크 공유" %}

그러면 이번에는 '링크 공유'라는 이름의 박스가 뜬다.
*'창도 많이 뜨고 뭐가 이렇게 복잡하냐'* 생각하겠지만 이게 폴더 공개 설정을 위한 마지막 창이니까 여기까지만 하면 된다.
여기서는 가장 위의 항목인 **사용 - 모든 웹 사용자**를 선택하면 되는데, 하단에 있는 **모든 사용자의 액세스 범위**가 **보기만 가능**이 선택되어 있는 것을 확인해야 한다.
'수정 가능' 또는 '댓글 작성 가능' 등이 선택되어 있다면 반드시 **보기만 가능**으로 바꾸어 준다.
그리고 나서 왼쪽 아래에 있는 **저장**을 클릭하면 된다.

그러면 다시 '공유 설정' 박스로 되돌아오게 되는데 아까와는 달리 아래 그림처럼 설정이 바뀌어 있음을 확인할 수 있다.
**웹에 공개 - 인터넷의 모든 사용자가 찾아서 볼 수 있습니다.**라는 제목으로 변경되었다.

{% include i-g.html id="1FMDDVrfxHB3sGzRxRXsU9BGVxbY3BZtK" alt="다시 '공유 설정' 상자로 돌아왔는데 액세스 권한이 설정이 바뀌어 있음을 알 수 있다." title="구글 드라이브에서 폴더를 공개하기 위한 설정: 공유 설정 이후" %}

여기에서 **완료**를 클릭해 주면 폴더의 공개를 위한 설정이 모두 끝난다.

## Google drive에 이미지 업로드
이제 공개 설정한 폴더에 아까 다운받았던 Grand Canyon 이미지 파일을 올려보았다.
구글 드라이브에서 위와 같이 폴더를 공개로 설정하고 나면 그 아래에 있는 모든 하위 폴더와 파일들도 같은 설정으로 바뀐다.
따라서 지금은 chobolife 아래에 만들어 둔 연, 월 이름의 폴더도 모두에게 공개된 상태이다.

chobolife/2019/07 폴더 아래에 Grand Canyon 파일을 올렸다.
파일을 업로드하려면 탐색기에서 파일을 드래그하여 웹브라우저에 올리면 된다.
그렇게 했더니 아래와 같이 제대로 업로드가 되었다.

{% include i-g.html id="1_EygBhHu5JtxkCVV_1rvPnwmPt4dSOA8" alt="공유 설정을 마치고 이미지 파일을 올린 모습이다." title="구글 드라이브에 이미지 파일을 업로드한 모습" %}

이제 이 이미지 파일의 주소를 얻으면 된다.
이미지 파일 위에서 우클릭한 후 **공유 가능한 링크 가져오기** 메뉴를 클릭한다.
그러면 이미지 파일 아래에 아래와 같은 툴팁 상자가 생김과 동시에 이미지의 주소가 자동으로 클립보드에 복사된다.

{% include i-g.html id="119N1cstj4Jl-VxA50w9PdYZMXYtJFGOM" alt="공유 가능한 링크 가져오기를 클릭하면 위와 같이 표시되며 저절로 클립보드에 이미지의 주소가 복사된다." title="구글 드라이브에서 이미지 공유하고 링크 가져오기" %}

위 툴팁 상자에서는 특별한 설정을 해 줄 것은 없으므로 무시하면 된다.
클립보드에는 아래와 같은 주소가 복사되어 있다.
```
https://drive.google.com/open?id=1fbAf4Hdbi5GZjeLVztTuhDpYDMVN_dCa
```

그런데 클립보드에 복사된 주소를 웹브라우저에 입력해 보면 이미지가 그대로 표시되는 것이 아니라 구글의 이미지 뷰어를 통해서 보인다.
아래 그림에서 이미지를 그대로 보여주는 것이 아니라 위와 아래에 별도의 컨트롤러가 있는 것을 볼 수 있다.

{% include i-g.html id="1fbAf4Hdbi5GZjeLVztTuhDpYDMVN_dCa" alt="클립보드에 복사된 주소를 그대로 입력하면 구글 드라이브의 자체 뷰어를 통해 이미지가 보인다." title="구글 드라이브의 이미지 뷰어" %}

직접 확인하려면 이 [링크][l-image-viewer]{:target='_blank'}를 클릭해도 된다.

이렇게 되면 문제가 있다.
이미지를 다른 사람에게 보여주기 위해 주소를 그대로 공유할 의도라면 모르겠지만 나는 웹페이지 안에서 이 이미지를 보여주려는 것이기 때문이다.
이렇게 되면 웹페이지 안에서 이미지가 제대로 표시될 수가 없다.

이것에 대해서 구글링을 해 보았으며 [이 블로그][l-image-hosting]{:target='_blank'}에 있는 방법으로 해결하였다.
클립보드에 복사된 주소 중에서 `drive.google.com/` 뒤의 `open?id=` 부분을 `uc?id=` 로 바꾸어 주면 된다는 것이다.
즉, 단순히 `open`을 `uc`로만 바꾸어 주면 되고 나머지 부분은 그대로 둔다.
아래 code block에서 비교해 보자면 원래 클립보드에 복사된 것은 윗줄인데 그것을 아랫줄로 바꾸어 준 것이다.
```
https://drive.google.com/open?id=1fbAf4Hdbi5GZjeLVztTuhDpYDMVN_dCa
https://drive.google.com/uc?id=1fbAf4Hdbi5GZjeLVztTuhDpYDMVN_dCa
```
이렇게 하면 주소를 웹브라우저에 쳤을 때 이미지가 웹브라우저에 바로 표시된다.
[링크][l-image-native]{:target='_blank'}를 클릭하여 확인할 수 있다.

이 포스팅에서 소개하지는 않지만 위와 같은 방법으로 동영상도 공유할 수 있다.
방법은 완전히 동일하며, 링크 주소의 `open` 부분을 그대로 두면 YouTube와 유사한 동영상 플레이어가 실행된다.

이어서 구글 드라이브에 올린 이미지를 Jekyll에서 표시하는 방법은 다음 포스팅에서 설명할 예정이다.

{% capture next %}
#### 다음 포스트

* [Jekyll post에 이미지 첨부하기]({{ site.baseurl }}{% link _posts/2019/2019-07-31-jekyll-image.md %})
{% endcapture %}

<div class="notice--primary">
  {{ next | markdownify }}
</div>

{% capture related %}
#### 관련 포스트

* [나의 Jekyll 여행기 (1)]({{ site.baseurl }}{% link _posts/2019/2019-07-26-start-jekyll-1.md %})
* [나의 Jekyll 여행기 (2)]({{ site.baseurl }}{% link _posts/2019/2019-07-27-start-jekyll-2.md %})
* [웹페이지에 지도 삽입하기]({{ site.baseurl }}{% link _posts/2019/2019-10-05-map-in-blog.md %})
{% endcapture %}

<div class="notice--primary">
  {{ related | markdownify }}
</div>

[l-github-pages]: https://pages.github.com/
[l-dropbox]: https://www.dropbox.com/
[l-google-drive]: https://www.google.com/drive/
[l-aws-s3]: https://aws.amazon.com/ko/s3/
[l-pixabay]: https://pixabay.com/
[l-image-viewer]: https://drive.google.com/open?id=1fbAf4Hdbi5GZjeLVztTuhDpYDMVN_dCa
[l-image-native]: https://drive.google.com/uc?id=1fbAf4Hdbi5GZjeLVztTuhDpYDMVN_dCa
[l-image-hosting]: http://www.somanet.xyz/2017/06/blog-post_21.html

